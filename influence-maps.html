<!DOCTYPE HTML>
<html>
	<head>
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/3/w3.css">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="shortcut icon" type="image/x-icon" href="favicon.ico">
	<!-- META TAGS -->
	<meta charset="UTF-8">
    <meta name="keywords" content="Game Programming, C#, Unity Engine, Champlain College, Influence Maps, Tactical Analysis">
    <meta name="author" content="Colin Deane">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Influence Map Project, Colin Deane">
	<!-- FONT -->
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Raleway">
	<style>
		.tstyle-raleway {
			font-family: Raleway, sans-sarif;
		}
		.auto-resizable-iframe {
			max-width: 650px;
			margin-left:auto;
		}

		.auto-resizable-iframe > div {
			position: relative;
			padding-bottom: 56.5%;
			height: 0px;
		}

		.auto-resizable-iframe iframe {
			position: absolute;
			top: 0px;
			left: 0px;
			width: 100%;
			height: 100%;
		}
	</style>
    <title>Colin Deane - Influence Maps</title>
  </head>
  <body>
	<!-- NAVBAR -->
	<div id="navbar">
		<nav class="w3-center w3-padding w3-card w3-black w3-wide">
			<a href="https://www.colindeane.me" class="tstyle-raleway w3-button w3-black w3-bar-item">Home</a>
			<a href="resume.pdf" class="tstyle-raleway w3-button w3-black w3-bar-item">Resume</a>
		</nav>
	</div>
	<!-- BANNER -->
	<div id="banner" class="w3-padding-top48">
		<div class="w3-display-container">
			<img src="/images/influencemaps/banner.png" alt="Banner" style="width:100%">
			
			<div class="w3-center w3-display-middle w3-padding-small w3-hide-small w3-text-white">
				<h1 class="tstyle-raleway w3-jumbo"><strong>Influence Maps</strong></h1>
				<h1 class="tstyle-raleway w3-wide">Colin Deane</h1>
			</div>
			
			<div class="w3-center w3-display-middle w3-padding-small w3-hide-medium w3-hide-large w3-text-white">
				<h3 class="tstyle-raleway"><strong>Influence Maps</strong></h3>
				<h4 class="tstyle-raleway">Colin Deane</h4>
			</div>
		</div>
	</div>
	
	<!-- CONTENT -->
	<div class ="w3-container w3-xxlarge w3-padding-24">
			<a href="https://github.com/colindme/Final_InfluenceMap"><i class="fa fa-github"></i></a>
			<a href="https://youtu.be/x0d1PMNyhHQ"><i class="fa fa-youtube-play"></i></a>
	</div>
	
	<div id="article-content-intro" class="w3-row w3-padding-24">
		<div class="w3-container w3-half w3-mobile" style="padding-left:64px;padding-right:64px">
			<h1 class="tstyle-raleway"><u><strong>Introduction: What are Influence Maps?</strong></u></h1>
			
			<h5 class="tstyle-raleway">How fun would a strategy game be if the AI sat there or just acted randomly? Probably not that fun. But I would argue that it’s more fun than an AI knowing absolutely everything and acting like a robot. The average AI should be somewhere between being a total rookie and a grandmaster. Part of the answer to making a “human-like” AI is the use of <strong>Tactical Analysis (AKA influence maps)</strong>. The simplest example of an influence map I can conjure up can be seen on the right</h5>
			<br>
			<h5 class="tstyle-raleway">In this case, a unit is on the grid (where the influence is highest). From there, its influence decays as it spreads into the neighboring tiles. If more units were present, their influence could combine (if they are friendly) or combat (if they are enemies). What this allows is a <strong>representation of the state of a graph/world/combat in a numerical way that an AI can analyze.</strong></h5>
			<br>
			<br>
			<h5 class="tstyle-raleway">While in my initial example I used units, influence maps are not limited to just military units. Alex Champandard’s article on gamedev.net talks about three broad categories that influence maps could fall into: <strong>situation summary</strong> maps, <strong>historical statistics</strong> maps, and <strong>future prediction</strong> maps.</h5>
			<h5 class="tstyle-raleway"><strong>For this project, my tech demo focused on Situation Summary maps</strong></h5>
		</div>
		<div class="w3-half w3-white">
			<div class="w3-container w3-mobile w3-left-align">
					<img src="/images/influencemaps/example1.png" align="left" alt="Example Influence Map" style="width:100%;max-width:650px;border-radius:20px;box-shadow: 4px 4px gray">
			</div>
		</div>
	</div>
	<div class="w3-row w3-padding-24">
		<div class="w3-container w3-third w3-mobile" style="padding-left:64px;padding-right:64px">
			<h5 class="tstyle-raleway"><strong>Situation Summary:</strong></h5>
			<h5 class="tstyle-raleway">“Who is in control of what area? Where are the borders between the territories? How much enemy presence is there in each area?” (Champandard). Can also be used to find where the valuable places are.</h5>
		</div>
		<div class="w3-container w3-third w3-mobile" style="padding-left:64px;padding-right:64px">
			<h5 class="tstyle-raleway"><strong>Historical Statistics:</strong></h5>
			<h5 class="tstyle-raleway">“Influence maps can also remember what happened for a certain period of time. Was this area being assaulted? How well did my previous attack go?” (Champandard). By storing and comparing influence maps (e.g. to see where the most territory is being lost/gained) historical data can be obtained and acted on.</h5>
		</div>
		<div class="w3-container w3-third w3-mobile" style="padding-left:64px;padding-right:64px">
			<h5 class="tstyle-raleway"><strong>Future Prediction:</strong></h5>
			<h5 class="tstyle-raleway">“Using the map of the terrain, you can figure out where an enemy would go and how his influence would extend in the future” (Champandard).</h5>
		</div>
	</div>
	<div class="w3-row w3-padding-24">
		<div class="w3-container w3-half w3-mobile" style="padding-left:64px;padding-right:64px">
			<div class="w3-container w3-mobile">
					<img src="/images/influencemaps/screenshot1.png" align="center" alt="Screenshot of regular map" style="width:100%;max-width:650px;border-radius:20px;box-shadow: 4px 4px gray">
			</div>	
		</div>
		<div class="w3-half w3-white">
			<div class="w3-container w3-mobile">
					<img src="/images/influencemaps/screenshot2.png" align="center" alt="Screenshot of map with influence overlayed" style="width:100%;max-width:650px;border-radius:20px;box-shadow: 4px 4px gray">
			</div>
		</div>
	</div>
	<div class="w3-row">
		<div class="w3-container w3-half w3-mobile" style="padding-left:64px;padding-right:64px;padding-bottom:10px">
			<h5 class="tstyle-raleway"><i>An example map made in my tech demo. It contains mountains, trees, lakes, fields, and an outpost.</i></h5>
		</div>
		<div class="w3-container w3-half w3-mobile" style="padding-left:64px;padding-right:64px;padding-bottom:10px">
			<h5 class="tstyle-raleway"><i>The influence map, specifically for logging, overlaid onto the example map. Orange is where the most logs are. Uses a set radius and sqrt dropoff to calculate influence.</i></h5>
		</div>
	</div>
	
	<!-- HOW TO CALCULATE INFLUENCE -->
	<div id="article-content-calculation" class="w3-row">
		<div class="w3-container w3-half w3-mobile w3-white" style="padding-left:64px;padding-right:64px">
			<h1 class="tstyle-raleway"><u><strong>How to Calculate Influence?</strong></u></h1>
			
			<h5 class="tstyle-raleway">Millington writes about three equations to calculate the influence of a square (from a specific source of influence). They are listed on page 513 and examples can be seen on the right.</h5>
			<ul>
				<li class="tstyle-raleway"><h5><strong>Linear dropoff: influence = initInfluence / (1 + distance)</strong></h5></li>
				<li class="tstyle-raleway"><h5><strong>Sqrt dropoff: influence = initInfluence / sqrt(1 + distance)</strong></h5></li>
				<li class="tstyle-raleway"><h5><strong>Exponential dropoff: initInfluence / (1+distance)^2</strong></h5></li>
			</ul>
			<br>
			<br>
			<h5 class="tstyle-raleway">For my tech demo (the example influence map seen above), <strong>I used the sqrt dropoff method.</strong> Since it requires a square root, this is the most expensive method. However, because I was working with such a small arena, the loss of efficiency was ignored.</h5>
			<br>
			<br>
			<h5 class="tstyle-raleway">Just doing the base implementation brings about some issues with performance. According to Millington, “execution time is <strong>O(nm)</strong>, and memory is <strong>O(m)</strong>, where m is the number of locations in the level, and n is the number of units” (514). This will pose a big issue if the grid gets large and enough units are placed. However, there are a few ways to improve this.</h5>
			<h5 class="tstyle-raleway">First off, influence maps <strong>do not need to be calculated every frame</strong>. For most large-scale decision making, influence can be calculated as needed. Because there can be time between each query, the influence mapping process can be interrupted allowing for the game to still run smoothly (Millington, 524).</h5>
			<br>
			<br>
			<h5 class="tstyle-raleway">There are also ways to alter the speed of processing. Millington also lists three methods for this on pages 514 to 516 . I implemented one of them and the article by Alex Champandard implements a different one. The three methods are:</h5>
			<ul>
				<li class="tstyle-raleway"><h5><strong>Radius - I implemented this one. Each unit has a different radius set and won’t contribute any more influence past that radius.</strong></h5></li>
				<li class="tstyle-raleway"><h5><strong>Convolution filtering - This one was implemented by Champandard and involves blurring the influence over a series of passes. The benefits of this are that it can be offloaded to be calculated on the GPU, thus speeding up processing (Millington, 516).</strong></h5></li>
				<li class="tstyle-raleway"><h5>Map flooding - This one just assumes that influence does not decay over distance. Instead, it uses Dijkstra’s Algorithm to spread and the influence at any one square is equal to the largest contributed by any single unit (Millington, 516).</h5></li>
			</ul>
			<h5 class="tstyle-raleway">Examples of the radius and convolution filtering methods can be seen below:</h5>
		</div>
		<div class="w3-half w3-white">
			<div class="w3-container w3-mobile w3-left-align">
					<img class="mySlides1" src="/images/influencemaps/lineardropoff.png" align="left" alt="Example showing linear drop off" style="width:100%;max-width:650px;border-radius:20px;box-shadow: 4px 4px gray">
					<img class="mySlides1" src="/images/influencemaps/sqrtdropoff.png" align="left" alt="Example showing sqrt drop off" style="width:100%;max-width:650px;border-radius:20px;box-shadow: 4px 4px gray">
					<img class="mySlides1" src="/images/influencemaps/expodropoff.png" align="left" alt="Example showing exponential dropoff" style="width:100%;max-width:650px;border-radius:20px;box-shadow: 4px 4px gray">
			</div>
			<div class="w3-padding-16 w3-left">
				<button class="w3-button w3-dark-gray" onclick="plusDivs(-1, 0)">&#10094;</button>
				<button class="w3-button w3-dark-gray" onclick="plusDivs(1, 0)">&#10095;</button>
			</div>
		</div>
	</div>
	<div class="w3-row w3-padding-24">
		<div class="w3-container w3-half w3-mobile w3-white" style="padding-left:64px;padding-right:64px">
			<img src="/images/influencemaps/radius.gif" align="left" alt="Radius influence gif" style="width:100%;max-width:650px;border-radius:20px;box-shadow: 4px 4px gray">
		</div>
		<div class="w3-container w3-half w3-mobile w3-white" style="padding-left:64px;padding-right:64px">
			<img src="/images/influencemaps/convolution.gif" align="left" alt="Convolution filtering influence gif" style="width:100%;max-width:650px;border-radius:20px;box-shadow: 4px 4px gray">
		</div>
	</div>
	<div class="w3-row">
		<div class="w3-container w3-half w3-mobile w3-white" style="padding-left:64px;padding-right:64px;padding-bottom:10px;">
			<h5 class="tstyle-raleway"><i>Switching between different influence maps with influence determined by the radius method</i></h5>
		</div>
		<div class="w3-container w3-half w3-mobile w3-white" style="padding-left:64px;padding-right:64px;padding-bottom:10px;">
			<h5 class="tstyle-raleway"><i>Convolution method (from Champandard's article)</i></h5>
		</div>
	</div>
	<!-- GENRES / PLATFORM SUSTAINABILITY -->
	<div id="article-content-genres-and-platforms" class="w3-row">
		<div class="w3-container w3-half w3-mobile w3-white" style="padding-left:64px;padding-right:64px">
			<h1 class="tstyle-raleway"><u><strong>Genres and Platforms</strong></u></h1>
			
			<h5 class="tstyle-raleway">All my sources listed the RTS genre as the starting place of influence maps which makes sense. Influence maps allow for dynamic reevaluation of a game world which is important when trying to do strategy in real time. There are a few cases where influence mapping might not be required. If the map you are implementing is really simple, you don’t really need to map it out (Champandad). For example, if everything takes place on an open plain, just use distance based calculations. Any game where the AI does not have to make complicated decisions probably does not require any kind of influence mapping (e.g. platformer where enemies follow a path or behavior that can be implemented using a behavior tree).</h5>
			<br>
			<br>
			<h5 class="tstyle-raleway">One interesting application I found is a paper about using influence mapping during pathfinding. What it found is that, “Influence map-based pathfinding opens a new possibility in pathfinding. Paths become aware of their surroundings, events or game specific characteristics (e.g., sound, faction location, line of sight, etc.). Game agents are therefore better informed at path planning, and changing the way they navigate through their environments.” (Adaixo, 44). A lot of resources focused on units but as shown in my tech demo, it can also be used for decision making on a higher level (an AI figuring out where to expand). In an FPS, the enemy AI might be able to use influence mapping to make more calculated decisions against a player.</h5>
			<br>
			<br>
			<h5 class="tstyle-raleway">As stated before, the base efficiency of influence maps is pretty bad although it can be improved. For split-second decisions, AI should probably delegate to something faster like a behavior tree. Because most parts of the algorithms can be interrupted, I think it could be adapted to a tile-based or strategy mobile game even though mobile devices do not have fast hardware. Influence maps overall have a lot of flexibility and potential and so should be considered a lot of the time when implementing an AI.</h5>
		</div>
	</div>
	
	<!-- Works cited -->
	<div id="article-content-works-cite" class="w3-row">
		<div class="w3-container w3-half w3-mobile w3-white" style="padding-left:64px;padding-right:64px">
			<h1 class="tstyle-raleway"><u><strong>Works Cited:</strong></u></h1>
			
			<h5 class="tstyle-raleway">Champandard, Alex J. “The Core Mechanics of Influence Mapping.” GameDev.net, GameDev.net, 8 June 2011, https://www.gamedev.net/tutorials/programming/artificial-intelligence/the-core-mechanics-of-influence-mapping-r2799/.</h5>
			<h5 class="tstyle-raleway"><i>This really was a great resource. The article contains a video going through it. Additionally, there is a talk done at GDC by him covering the same topic.</i></h5>
			<br>
			<h5 class="tstyle-raleway">Adaixo, Michael. Influence Map-Based Pathfinding Algorithms in Video Games. 2014. https://ubibliorum.ubi.pt/bitstream/10400.6/5517/1/3443_6881.pdf</h5>
			<h5 class="tstyle-raleway">Millington, Ian. AI for Games. CRC Press, 2022.</h5>
			
		</div>
	</div>
	
	<!-- FOOTER -->
	<footer class=" w3-container w3-padding w3-black w3-center">
		<h1 class="tstyle-raleway">Follow/Contact me</h1>
		<div class ="w3-container w3-xxlarge">
			<a href="https://github.com/colindme"><i class="fa fa-github"></i></a>
			<a href="https://www.linkedin.com/in/colin-deane/"><i class="fa fa-linkedin"></i></a>
		</div>
		<div class="w3-container">
			<a href="mailto:colin.deane@mymail.champlain.edu">
				<i class="fa fa-envelope w3-xxlarge"></i>
				<h3 style="tstyle-raleway">colin.deane@mymail.champlain.edu</h3>
			</a>
		</div>
	</footer>
	
	<script>
		var slideIndex = [1];
		var slideId = ["mySlides1"]
		showDivs(1, 0);

		function plusDivs(n, no) {
			showDivs(slideIndex[no] += n, no);
		}

		function showDivs(n, no) {
			var i;
			var x = document.getElementsByClassName(slideId[no]);
			if (n > x.length) {slideIndex[no] = 1}
			if (n < 1) {slideIndex[no] = x.length}
			for (i = 0; i < x.length; i++) {
				x[i].style.display = "none";  
			}
			x[slideIndex[no]-1].style.display = "inline";  
		}
	</script>
  </body>
</html>